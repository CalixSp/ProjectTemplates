{
    "type": "Ext.app.Controller",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "stores": [
            "Records"
        ],
        "designer|userClassName": "RecordController"
    },
    "designerId": "2856dba3-c512-4b02-8986-a3e844ab0885",
    "cn": [
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "view",
                "designer|params": [
                    "target",
                    "record"
                ],
                "implHandler": [
                    "",
                    "var details = this.getDetailPanel(),\t// Detail panel via controller ref",
                    "    toolbar = this.getToolbar();\t\t// Detail panel toolbar via controller ref",
                    "",
                    "// Update the detail panel with the selected row's data",
                    "details.update(record.data);",
                    "",
                    "// Show toolbar",
                    "toolbar.show();"
                ],
                "name": "select",
                "scope": "me",
                "designer|controlQuery": "#RecordGrid"
            },
            "designerId": "df446b75-e4d7-445e-89e4-61f7a5aefeae"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "add",
                "designer|params": [
                    "target"
                ],
                "implHandler": [
                    "",
                    "var window = Ext.create('MyApp.view.RecordForm'),\t// Create new form window",
                    "\tform = window.down('form').getForm(),\t\t\t// Get form",
                    "    model = Ext.create('MyApp.model.Record');\t\t// Create new Record model",
                    "",
                    "// Associate model with form",
                    "form.loadRecord(model);",
                    "",
                    "// Show window",
                    "window.show();",
                    ""
                ],
                "name": "click",
                "scope": "me",
                "designer|controlQuery": "#AddButton"
            },
            "designerId": "e36d723b-3313-48ef-ac07-dece1e00f055"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "edit",
                "designer|params": [
                    "target"
                ],
                "implHandler": [
                    "var data = target.up('panel').data,\t\t\t\t\t// Assosiated data",
                    "    store = this.getRecordsStore(),\t\t\t\t\t// Record store",
                    "    record = store.getById(data.id),\t\t\t\t// Current record",
                    "    window = Ext.create('MyApp.view.RecordForm'),\t// Create new form window",
                    "    form = window.down('form').getForm();\t\t\t// Get form",
                    "",
                    "// Load record model into form",
                    "form.loadRecord(record);",
                    "",
                    "// Show window",
                    "window.show();",
                    ""
                ],
                "name": "click",
                "scope": "me",
                "designer|controlQuery": "#DetailPanel button[text=Edit]"
            },
            "designerId": "6c1bbf38-d9cb-47ea-9ac3-355220170579"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "save",
                "designer|params": [
                    "target"
                ],
                "implHandler": [
                    "",
                    "var form = target.up('form').getForm(),\t\t// Form",
                    "    window = target.up('window'),\t\t\t// Form window",
                    "    detailPanel = this.getDetailPanel(),\t// Detail panel",
                    "    toolbar = this.getToolbar(),\t\t\t// Detail panel toolbar",
                    "    record = form.getRecord(),\t\t\t\t// Record associated with form",
                    "\tisNew = !record.get('id'),\t\t\t\t// Is new if no id exists",
                    "    store = this.getRecordsStore();\t\t\t// Record store",
                    "",
                    "",
                    "// Update associated record with form values",
                    "var errors = form.updateRecord();",
                    "",
                    "// Valid",
                    "if (form.isValid()) {",
                    "    ",
                    "    // Add to store if new record",
                    "    if (isNew) {",
                    "        ",
                    "        // Assign the record ID",
                    "\t\t// Normally, this would be a generated ID",
                    "        var id = store.getTotalCount() + 1;",
                    "        record.set(\"id\", id);",
                    "        ",
                    "        // Add to store",
                    "        store.add(record);",
                    "        ",
                    "    }",
                    "    ",
                    "    // Commit changes ",
                    "    store.commitChanges();",
                    "    ",
                    "    // Update detail panel",
                    "    detailPanel.update(record.getData());",
                    "    ",
                    "    // Close window",
                    "    window.destroy();",
                    "    ",
                    "}",
                    "",
                    "",
                    "// Invalid",
                    "else {",
                    "    ",
                    "    // Show errors on form",
                    "\tform.markInvalid(errors);",
                    "    ",
                    "}"
                ],
                "name": "click",
                "scope": "me",
                "designer|controlQuery": "#RecordForm button[text=Save]"
            },
            "designerId": "f27cbf84-7243-4479-90a4-df42d4f775ab"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "cancelEdit",
                "designer|params": [
                    "target"
                ],
                "implHandler": [
                    "",
                    "// Get the window and close it",
                    "var window = target.up(\"window\");",
                    "window.destroy();",
                    ""
                ],
                "name": "click",
                "scope": "me",
                "designer|controlQuery": "#RecordForm button[text=Cancel]"
            },
            "designerId": "d0c4a0b7-dfc7-4587-919c-a603c5f4a4ff"
        },
        {
            "type": "controlleraction",
            "reference": {
                "name": "listeners",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "delete",
                "designer|params": [
                    "target"
                ],
                "implHandler": [
                    "",
                    "var me = this;",
                    "",
                    "// Confirm this delete",
                    "Ext.MessageBox.confirm('Confirm', 'Are you sure you want to delete this record?', function() {",
                    "",
                    "\tvar data = target.up('panel').data,\t\t\t// Get assosiated data\t",
                    "        store = me.getRecordsStore(),\t\t\t// Get record store",
                    "        record = store.getById(data.id),\t\t// Get current record",
                    "        detailPanel = me.getDetailPanel(),\t\t// Get detail panel\t",
                    "        toolbar = me.getToolbar();\t\t\t\t// Get toolbar",
                    "        ",
                    "    // Delete from store",
                    "\tstore.remove(record);",
                    "",
                    "\t// Clear panel content",
                    "    detailPanel.update(null);",
                    "    ",
                    "    // Hide toolbar",
                    "    toolbar.hide();",
                    "  ",
                    "    ",
                    "});"
                ],
                "name": "click",
                "scope": "me",
                "designer|controlQuery": "#DetailPanel button[text=Delete]"
            },
            "designerId": "b98ca3bb-f3ae-4325-bb62-345e81cd9b07"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "detailPanel",
                "selector": "#DetailPanel"
            },
            "designerId": "d5fcba7c-366a-4285-baa8-1ad5e532d2d0"
        },
        {
            "type": "controllerref",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "ref": "toolbar",
                "selector": "#DetailPanel toolbar",
                "xtype": null
            },
            "designerId": "fc4ec857-1bbe-40eb-800c-d002cae9f090"
        }
    ]
}